# 🦆 🦆 protections-onweek-malduck 🦆 🦆

Implementing a battling of malducks to stream malware captured from the endpoint to Elastic cloud

## Our Inspiration

> Malware can be 'fowl'
> But we can 'quack' its secrets
> With our friend malduck

## Our Goal

Build a solution that can execute in a container that can stream events from an
Elasticsearch cluster that contains captured bytes from malware detected on the
endpoint, process it using malduck with an ECS-friendly output, then store it
in Elasticsearch (optionally, a different cluster)

## Building

Build quietly and run:

```bash
docker run --rm -it $(docker build -q .) --help
```

Successful execution will require a configuration, for instance the following .env file (passed to docker):

```bash
CLOUD_ID=security-cluster:dXMtd2VzdDEuZ2NwLmNsb3VkLmVzLmlvJGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1JGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1
INPUT_ELASTICSEARCH_APIKEY=XXXXXXXXXXXXXXXXXXXX:XXXXXXXXXXXXXXXXXXXX
INPUT_ELASTICSEARCH_INDEX=logs-endpoint.alerts-*
OUTPUT_ELASTICSEARCH_APIKEY=XXXXXXXXXXXXXXXXXXXX:XXXXXXXXXXXXXXXXXXXX
```

Then, you can run like so:

```bash
docker run --rm -it --env-file .env $(docker build -q .) --help

```
